---
title: Update App Manifest to Enable SSO
description: Learn how to add code configuration, handle an access token, receive token, and handle app user log out for enabling in Teams bots. Sample (C#, Node.js).
ms.topic: how-to
ms.localizationpriority: high
zone_pivot_groups: enable-sso
---
# Add code to enable SSO in your bot app

Before you add code to enable single sign-on (SSO), ensure that you've configured your app and bot resource in Microsoft Entra admin center.

> [!div class="nextstepaction"]
> [Configure bot app in Microsoft Entra ID](bot-sso-register-aad.md)

You need to configure your app's code to obtain an access token from Microsoft Entra ID. The access token is issued on behalf of the bot app.

> [!NOTE]
> If you've built your Teams app using Microsoft Teams Toolkit, you can enable SSO for your app using the instructions in the Tools and SDKs module. For more information, see [Add single sign-on to Teams app](../../../toolkit/add-single-sign-on.md). Teams Toolkit supports SSO for JavaScript and TypeScript apps in Visual Studio Code, and in Teams Toolkit 17.4 preview 3 for C# apps.

::: zone pivot="bot-app"

This section covers:

1. [Update development environment variables](#update-development-environment-variables)
1. [Add code to handle an access token](#add-code-to-handle-an-access-token)
1. [Add code to receive the token](#add-code-to-receive-the-token)
1. [Handle app user log out](#handle-app-user-log-out)

## Update development environment variables

You've configured client secret and OAuth connection setting for the app in Microsoft Entra ID. You must configure the code with these values.

To update the development environment variables:

1. Open the bot app project.
1. Open the environment file for your project.
1. Update the following variables:

    - For `MicrosoftAppId`, update the bot ID from Microsoft Entra ID.
    - For `MicrosoftAppPassword`, update the client secret.
    - For `ConnectionName`, update the name of the OAuth connection you configured in Microsoft Entra ID.
    - For `MicrosoftAppTenantId`, update the tenant ID.

1. Save the file.

You've now configured the required environment variables for your bot app and SSO. Next, add the code for handling bot tokens.

## 